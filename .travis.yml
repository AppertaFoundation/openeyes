language: generic
dist: bionic

services:
  - docker

before_install:
  - docker pull appertaopeneyes/ci:latest

script:
  - docker run --name=oe -e OE_MODE=TEST -e BUILD_BRANCH=$TRAVIS_PULL_REQUEST_BRANCH -v ~/.ssh/id_rsa:/run/secrets/SSH_PRIVATE_KEY -v $TRAVIS_BUILD_DIR:/var/www/openeyes appertaopeneyes/ci:latest


notifications:
  slack:
    on_pull_requests: false
    rooms:
      - secure: "$slack_room"
    on_success: change
    on_failure: always
