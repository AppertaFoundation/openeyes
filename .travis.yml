language: generic
dist: bionic

services:
  - docker

jobs:
  include:
    - script: docker-compose -f protected/tests/docker-compose.yml run --use-aliases -e BEHAT_HEADLESS=true -e BUILD_BRANCH=$TRAVIS_PULL_REQUEST_BRANCH behat
      name: "Behat"
    - script: docker-compose -f protected/tests/docker-compose.yml run --use-aliases -e BUILD_BRANCH=$TRAVIS_PULL_REQUEST_BRANCH -e WAIT_AFTER_HOSTS=30 phpunit
      name: "PHPUnit"


notifications:
  slack:
    on_pull_requests: false
    rooms:
      - secure: "$slack_room"
    on_success: change
    on_failure: always
